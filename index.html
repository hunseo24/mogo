<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>아날로그 시계 타임테이블</title>
<style>
:root{
  --bg:#f0f4f8; --accent:#1c2a4a; --card:#fff; --muted:#6b7280;
}
body{
  font-family:"Noto Sans KR","맑은 고딕",sans-serif;
  background:var(--bg); color:#0b1220; margin:0; padding:24px;
  display:flex; flex-direction:column; align-items:center; min-height:100vh; box-sizing:border-box;
}
.container{width:100%; max-width:920px;}
h1{margin:6px 0 18px; font-size:20px; text-align:center;}
.card{background:var(--card); padding:18px; border-radius:12px; box-shadow:0 6px 18px rgba(12,20,40,0.06); margin-bottom:18px;}
#setup label{display:block; margin:8px 0; cursor:pointer; font-size:15px;}
.btn{background:var(--accent); color:#fff; border:none; padding:10px 16px; border-radius:8px; cursor:pointer; font-size:15px;}
.btn:active{transform:translateY(1px);}
.clock-wrap{display:flex; gap:24px; align-items:center; justify-content:center; flex-wrap:wrap; padding:18px;}
.clock{position:relative; width:300px; height:300px; border-radius:50%; background:linear-gradient(180deg,#fff,#f7fafc); border:10px solid var(--accent); box-shadow:0 8px 22px rgba(15,23,42,0.08); display:flex; align-items:center; justify-content:center;}
.hand{position:absolute; bottom:50%; left:50%; transform-origin:bottom; transform:translateX(-50%) rotate(0deg); background:var(--accent); border-radius:4px;}
.hour{width:8px; height:75px; z-index:3;}
.minute{width:6px; height:100px; z-index:2;}
.second{width:3px; height:120px; background:#e11d48; z-index:1;}
.center-dot{position:absolute; width:14px; height:14px; background:var(--accent); border-radius:50%; z-index:5;}
.controls{text-align:center; margin-top:12px;}
.progress-wrap{width:100%; max-width:560px; margin:8px auto 0;}
.progress-labels{display:flex; justify-content:space-between; font-size:13px; color:var(--muted); margin-bottom:6px;}
.progress{height:12px; background:#e6eef7; border-radius:999px; overflow:hidden;}
.progress > .bar{height:100%; width:0%; background: linear-gradient(90deg,#3b82f6,#06b6d4); transition:width 0.3s linear;}
@media (max-width:640px){
  .clock{width:230px; height:230px;}
  .hour{height:58px;} .minute{height:78px;} .second{height:90px;}
}
</style>
</head>
<body>
<div class="container">
<h1>아날로그 시계 타임테이블</h1>

<div id="setup" class="card">
<h3>교시 선택</h3>
<label><input type="checkbox" value="1"> 1교시 국어 (08:25~10:00)</label>
<label><input type="checkbox" value="2"> 2교시 수학 (10:20~12:10)</label>
<label><input type="checkbox" value="3"> 3교시 영어 (13:00~14:20)</label>
<label><input type="checkbox" value="4k"> 4교시 한국사 (14:40~15:20)</label>
<label><input type="checkbox" value="4s"> 4교시 사회탐구 (15:25~16:15)</label>
<label><input type="checkbox" value="4c"> 4교시 과학탐구 (16:20~17:10)</label>
<div style="margin-top:12px;">
<button class="btn" onclick="startClock()">시작</button>
</div>
</div>

<div id="clockPage" class="card" style="display:none;">
<div class="clock-wrap">
<div class="clock">
  <div class="hand hour" id="hour"></div>
  <div class="hand minute" id="minute"></div>
  <div class="hand second" id="second"></div>
  <div class="center-dot"></div>
</div>
<div style="min-width:220px;">
<div style="font-size:16px; font-weight:700;" id="currentLesson">--</div>
<div style="color:var(--muted); margin-top:6px;" id="currentTime">--:--:--</div>
<div class="controls">
<button class="btn" onclick="rewindTime()">⏪ 30초 뒤로</button>
<button class="btn" onclick="advanceTime()">⏩ 30초 앞으로</button>
</div>
<div style="margin-top:10px; text-align:center;">
<button style="background:#ef4444;" class="btn" onclick="stopAll()">중지</button>
<button style="background:#f59e0b;" class="btn" id="pauseBtn" onclick="togglePause()">일시정지</button>
</div>
</div>
</div>
<div class="progress-wrap">
<div class="progress-labels">
  <div id="lesson-start-label">시작</div>
  <div id="lesson-end-label">종료</div>
</div>
<div class="progress"><div class="bar" id="progress-bar"></div></div>
</div>
</div>
</div>

<script>
// 교시 및 멘트 정의
const schedule={
  "1":{name:"1교시 국어",start:"08:25",end:"10:00"},
  "2":{name:"2교시 수학",start:"10:20",end:"12:10"},
  "3":{name:"3교시 영어",start:"13:00",end:"14:20"},
  "4k":{name:"4교시 한국사",start:"14:40",end:"15:20"},
  "4s":{name:"4교시 사회탐구",start:"15:25",end:"16:15"},
  "4c":{name:"4교시 과학탐구",start:"16:20",end:"17:10"}
};
const lessonMent={
  "1":{regular:["제 1교시 예비령입니다. 감독관께서는 답안지를 책상 오른쪽에 배부해 주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 1교시 국어영역 답안지인지 확인하십시오.","제 1교시 준비령입니다. 수험생은 두 손을 책상 아래로 내리고 조용히 기다립니다. 감독관께서는 문제지를 책상 왼쪽에 배부해주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 표지를 제외한 문제지 면수가 16면인지와 각 면의 인쇄상태를 확인한 다음 문제지에 성명과 수험번호를 기재하여 주십시오. 표지의 필적확인문구를 답안지에 필적확인란에 정자체로 기재하십시오.","제 1교시 본령입니다."],warn:"제 1교시 종료 10분전입니다.",end:"제 1교시 종료령입니다. 수험생은 필기도구를 놓고 답안지는 엎어서 오른쪽에, 문제지는 표지를 덮어서 왼쪽에 놓고 조용히 기다립니다."},
  "2":{regular:["제 2교시 예비령입니다. 감독관께서는 답안지를 책상 오른쪽에 배부해 주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 2교시 수학영역 답안지인지 확인하십시오.","제 2교시 준비령입니다. 수험생은 두 손을 책상 아래로 내리고 조용히 기다립니다. 감독관께서는 문제지를 책상 왼쪽에 배부해주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 표지를 제외한 문제지 면수가 12면인지와 각 면의 인쇄상태를 확인한 다음 문제지에 성명과 수험번호를 기재하여 주십시오. 표지의 필적확인문구를 답안지에 필적확인란에 정자체로 기재하십시오.","제 2교시 본령입니다."],warn:"제 2교시 종료 10분전입니다.",end:"제 2교시 종료령입니다. 수험생은 필기도구를 놓고 답안지는 엎어서 오른쪽에, 문제지는 표지를 덮어서 왼쪽에 놓고 조용히 기다립니다."},
  "3":{regular:["제 3교시 예비령입니다. 감독관께서는 답안지를 책상 오른쪽에 배부해 주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 3교시 영어영역 답안지인지 확인하십시오.","제 3교시 준비령입니다. 수험생은 두 손을 책상 아래로 내리고 조용히 기다립니다. 감독관께서는 문제지를 책상 왼쪽에 배부해주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 표지를 제외한 문제지 면수가 8면인지와 각 면의 인쇄상태를 확인한 다음 문제지에 성명과 수험번호를 기재하여 주십시오. 표지의 필적확인문구를 답안지에 필적확인란에 정자체로 기재하십시오. 제 3교시 영어영역은 타종없이 시작합니다.","듣기평가입니다."],warn:"제 3교시 종료 10분전입니다.",end:"제 3교시 종료령입니다. 수험생은 필기도구를 놓고 답안지는 엎어서 오른쪽에, 문제지는 표지를 덮어서 왼쪽에 놓고 조용히 기다립니다."},
  "4k":{regular:["제 4교시 한국사 영역 예비령입니다. 감독관께서는 답안지를 책상 오른쪽에 배부해 주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 4교시 한국사영역 답안지인지 확인하십시오.","제 4교시 한국사 영역 준비령입니다. 수험생은 두 손을 책상 아래로 내리고 조용히 기다립니다. 감독관께서는 문제지를 책상 왼쪽에 배부해주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 표지를 제외한 문제지 면수가 4면인지와 각 면의 인쇄상태를 확인한 다음 문제지에 성명과 수험번호를 기재하여 주십시오. 표지의 필적확인문구를 답안지에 필적확인란에 정자체로 기재하십시오.","제 4교시 한국사 영역 본령입니다."],warn:"제 4교시 한국사 영역 종료 5분전입니다.",end:"제 4교시 한국사 영역 종료령입니다. 수험생은 필기도구를 놓고 답안지는 엎어서 오른쪽에, 문제지는 표지를 덮어서 왼쪽에 놓고 조용히 기다립니다."},
  "4s":{regular:["제 4교시 탐구 영역 중 사회탐구 영역 예비령입니다. 감독관께서는 답안지를 책상 오른쪽에 배부해 주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 4교시 사회탐구영역 답안지인지 확인하십시오.","제 4교시 사회탐구 영역 준비령입니다. 수험생은 두 손을 책상 아래로 내리고 조용히 기다립니다. 감독관께서는 문제지를 책상 왼쪽에 배부해주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 표지를 제외한 문제지 면수가 6면인지와 각 면의 인쇄상태를 확인한 다음 문제지에 성명과 수험번호를 기재하여 주십시오. 표지의 필적확인문구를 답안지에 필적확인란에 정자체로 기재하십시오.","제 4교시 사회탐구 영역 본령입니다."],warn:"제 4교시 탐구 영역 중 사회탐구 영역 종료 5분전입니다.",end:"제 4교시 탐구 영역 중 사회탐구 영역 종료령입니다. 수험생은 필기도구를 놓고 답안지는 엎어서 오른쪽에, 문제지는 표지를 덮어서 왼쪽에 놓고 조용히 기다립니다."},
  "4c":{regular:["제 4교시 탐구 영역 중 과학탐구 영역 예비령입니다. 감독관께서는 답안지를 책상 오른쪽에 배부해 주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 4교시 과학탐구영역 답안지인지 확인하십시오.","제 4교시 과학탐구 영역 준비령입니다. 수험생은 두 손을 책상 아래로 내리고 조용히 기다립니다. 감독관께서는 문제지를 책상 왼쪽에 배부해주시되 결시자 책상 위에도 놓아 주십시오. 수험생은 표지를 제외한 문제지 면수가 6면인지와 각 면의 인쇄상태를 확인한 다음 문제지에 성명과 수험번호를 기재하여 주십시오. 표지의 필적확인문구를 답안지에 필적확인란에 정자체로 기재하십시오.","제 4교시 과학탐구 영역 본령입니다."],warn:"제 4교시 탐구 영역 중 과학탐구 영역 종료 5분전입니다.",end:"제 4교시 탐구 영역 종료령입니다. 수험생은 필기도구를 놓고 답안지는 엎어서 오른쪽에, 문제지는 표지를 덮어서 왼쪽에 놓고 조용히 기다립니다."}
};
// 공용 음악
let startAudio, after5Audio, after10Audio, endAudio;

let selected=[],currentLessonIndex=0,currentTime=null,timerId=null,firedEvents={},paused=false;
const hourEl=document.getElementById('hour'),minuteEl=document.getElementById('minute'),secondEl=document.getElementById('second');
const currentTimeEl=document.getElementById('currentTime'),currentLessonEl=document.getElementById('currentLesson');
const progressBar=document.getElementById('progress-bar'),lessonStartLabel=document.getElementById('lesson-start-label'),lessonEndLabel=document.getElementById('lesson-end-label');
const setupEl=document.getElementById('setup'),clockPageEl=document.getElementById('clockPage');

function parseTimeHM(hm){const[h,m]=hm.split(':').map(Number);return{h,m}}
function makeDate(h,m){const d=new Date(); d.setHours(h,m,0,0); return d;}

function startClock(){
  selected=Array.from(document.querySelectorAll('#setup input[type=checkbox]:checked')).map(i=>i.value);
  if(selected.length===0) return alert("교시를 선택해주세요.");
  setupEl.style.display="none"; clockPageEl.style.display="block";
  currentLessonIndex=0; firedEvents={};
  
  // Audio 객체 생성 (브라우저 정책 문제 방지)
  startAudio = new Audio('music/start.mp3');
  after5Audio = new Audio('music/after5.mp3');
  after10Audio = new Audio('music/after10.mp3');
  endAudio = new Audio('music/end.mp3');

  startLesson(selected[currentLessonIndex]);
  startTimer();
}

function startLesson(key){
  const s=parseTimeHM(schedule[key].start);
  currentTime=makeDate(s.h,s.m);
  currentLessonEl.textContent=schedule[key].name;
  lessonStartLabel.textContent=schedule[key].start;
  lessonEndLabel.textContent=schedule[key].end;
  firedEvents[currentLessonIndex]={};
}

function updateClock(){
  const h=currentTime.getHours(), m=currentTime.getMinutes(), s=currentTime.getSeconds();
  currentTimeEl.textContent=`${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
  hourEl.style.transform=`translateX(-50%) rotate(${30*h+m/2}deg)`;
  minuteEl.style.transform=`translateX(-50%) rotate(${6*m}deg)`;
  secondEl.style.transform=`translateX(-50%) rotate(${6*s}deg)`;
}

function handleTime(){
  if(currentLessonIndex>=selected.length) return;
  const key=selected[currentLessonIndex];
  const start=parseTimeHM(schedule[key].start), end=parseTimeHM(schedule[key].end);
  const startDate=makeDate(start.h,start.m), endDate=makeDate(end.h,end.m);
  const diff=(currentTime-startDate)/1000, total=(endDate-startDate)/1000;

  // 시작,5분,10분 이벤트
  const times=[0,300,600];
  times.forEach((t,i)=>{
    if(diff>=t && !firedEvents[currentLessonIndex]?.[i]){
      firedEvents[currentLessonIndex]={...firedEvents[currentLessonIndex],[i]:true};
      let audio=null;
      if(i===0) audio=startAudio;
      else if(i===1) audio=after5Audio;
      else audio=after10Audio;
      playAudio(audio);
      setTimeout(()=>speak(lessonMent[key].regular[i]||""),500);
    }
  });

  // 종료 전 경고
  const warnOffset=(key.startsWith("4")?300:600);
  if(total-diff<=warnOffset && !firedEvents[currentLessonIndex]?.warn){
    firedEvents[currentLessonIndex]={...firedEvents[currentLessonIndex],warn:true};
    speak(lessonMent[key].warn);
  }

  // 종료
  if(diff>=total && !firedEvents[currentLessonIndex]?.end){
    firedEvents[currentLessonIndex]={...fired
